!function(t){"use strict";!function(){tinymce.create("tinymce.plugins.rm_tinymce_plugin",{init:function(t,n){var e=this;e.url=n,t.addButton("hint",{title:"Hint",cmd:"insert_hint",text:"hint"}),t.addButton("mdash",{title:"Insert —",cmd:"insert_mdash",text:"—"}),t.addCommand("insert_hint",function(){var n=t.selection.getContent(),e="[hint title=Hint]"+n+"[/hint]";t.execCommand("mceInsertContent",0,e)}),t.addCommand("insert_mdash",function(){t.selection.getContent();t.execCommand("mceInsertContent",0,"&#8239;&mdash;&#8198;")}),t.on("BeforeSetContent",function(t){t.content=e.renderShortcodes(t.content)}),t.on("ExecCommand",function(t,n){"mceInsertContent"===n&&tinyMCE.activeEditor.setContent(e.renderShortcodes(tinyMCE.activeEditor.getContent()))}),t.on("PostProcess",function(t){t.get&&(t.content=e.restoreShortcodes(t.content))})},renderShortcodes:function(t){var n=this;return t=t.replace(/\[img(.*?)\]/g,function(t,e){var i=n._parseParams(e);return i.tag="img",'<media-wrapper class="rm-shortcode" data-rm-params="'+tinyMCE.DOM.encode(JSON.stringify(i))+'"  contenteditable="false"><img src="'+i.f+'" srcset="'+i.rf+' 2x" width="'+i.w+'" height="'+i.h+'"></img></media-wrapper>'}),t=t.replace(/\[hint([\s\S]*)\]([\s\S]*)\[\/hint\]/g,function(t,e,i){var r=n._parseParams(e);return r.tag="hint",'<hint class="rm-shortcode def-hint-box" data-rm-shortcode="hint"  contenteditable="false"><div class="def-hint-box__toggle" contenteditable="true">'+r.title+'</div><div class="def-hint-box__content" contenteditable="true"><p>'+i+"</p></div></hint>"})},restoreShortcodes:function(t){return t=t.replace(/<media-wrapper[^>]*data-rm-params="([^">]*)"[^>]*>(.*?)<\/media-wrapper>/g,function(t,n,e){var i=JSON.parse(tinyMCE.DOM.decode(n)),r=["\n["+i.tag];for(var o in i)"tag"!=o&&r.push(o+'="'+i[o]+'"');return r.push("]"),r.join(" ")}),t=t.replace(/<hint[^>]*data-rm-shortcode="hint"[^>]*>([\s\S]*?)<\/hint>/gi,function(t,n){var e=/<div[^>]*class="def-hint-box__toggle"[^>]*>([\s\S]*?)<\/div>/gi,i=/<div[^>]*class="def-hint-box__content"[^>]*>([\s\S]*?)<\/div>/gi,r=e.exec(n)[1],o=i.exec(n)[1];return'\n[hint title="'+r.trim()+'"]'+o.trim()+"[/hint]"}),t=t.replace(/<a([^>]*?)>([\s\S]*?)<\/a>/gi,function(t,n,e){return-1!=n.indexOf("v-rlink")?t:"<a v-rlink "+n.trim()+">"+e+"</a>"})},_parseParams:function(t){var n={},e=/([^\s=]*)=("[^"]*"|[^\s]*)/gi;return t.match(e).forEach(function(t){if(0!=t.length){var e=/([^\s=]*)=("[^"]*"|[^\s]*)/.exec(t);e.length<=1||!e[1]||!e[2]||(n[e[1]]=e[2].replace(/"/g,""))}}),n},getInfo:function(){return{longname:"RM shortcode replace",author:"John Petrov",authorurl:"https://readymag.com",infourl:"",version:"1.0"}}}),tinymce.PluginManager.add("rm_tinymce_plugin",tinymce.plugins.rm_tinymce_plugin)}()}(window);